<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Rid Rally: Monthly Riddance Goal Tracker</title>
  <script defer>
    // UUID generator (v4)
    function generateUUID() {
      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
        const r = Math.random() * 16 | 0;
        const v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
    }

    const DEVICE_KEY = (() => {
      let id = localStorage.getItem('device-id');
      if (!id) {
        id = generateUUID();
        localStorage.setItem('device-id', id);
      }
      return id;
    })();

    const now = new Date();
    const monthYear = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    const STORAGE_KEY = `goal-tracker-${DEVICE_KEY}-${monthYear}`;

    document.addEventListener("DOMContentLoaded", () => {
      const goalTitleEl = document.getElementById("goal-title");
      const monthNames = [
        "January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
      ];
      const now = new Date();
      const currentMonthName = monthNames[now.getMonth()];
      goalTitleEl.textContent = `ğŸ¯ My ${currentMonthName} Goal`;
      // State
      let originalGoal = 60;
      let goal = originalGoal;
      let progress = { throw: 0, give: 0, sell: 0 };

      // DOM Elements
      const goalEl = document.getElementById("goal-value");
      const remainingEl = document.getElementById("remaining");

      // Load saved data
      const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
      if (saved) {
        originalGoal = saved.originalGoal;
        goal = saved.goal;
        progress = saved.progress;
      }

      const updateDisplay = () => {
        goalEl.textContent = goal;
        const total = progress.throw + progress.give + progress.sell;
        const remaining = goal - total;
        const remainingEl = document.getElementById("remaining");
        const specialPower = document.getElementById('special-bonus-power');

        document.getElementById("throw-value").textContent = progress.throw;
        document.getElementById("give-value").textContent = progress.give;
        document.getElementById("sell-value").textContent = progress.sell;

        const showProgress = !(goal === originalGoal && total === 0);
        document.getElementById("progress-wrapper").classList.toggle("hidden", !showProgress);

        // Reset classes
        remainingEl.classList.remove("text-gray-300", "text-green-400", "font-bold", "font-normal");

        if (remaining > 0) {
          // Still under goal
          remainingEl.textContent = `Only ${remaining} more left to go! ğŸ‘`;
          remainingEl.classList.add("text-gray-300", "font-normal");
        } else if (remaining === 0) {
          // Exactly hit the goal
          remainingEl.textContent = `Goal met! ğŸ˜ Why not one more?`;
          remainingEl.classList.add("text-green-400", "font-bold");
        } else {
          // Surpassed the goal
          remainingEl.textContent = `+${Math.abs(remaining)} over. ğŸ‰`;
          remainingEl.classList.add("text-green-400", "font-bold");
          specialPower.classList.remove('hidden');
        }

        // Save
        localStorage.setItem(STORAGE_KEY, JSON.stringify({
          originalGoal,
          goal,
          progress
        }));
      };

      const adjustGoal = (delta) => {
        goal += delta;
        updateDisplay();
      };

      const adjustCategory = (type, delta) => {
        if (progress[type] + delta >= 0) {
          progress[type] += delta;
          updateDisplay();
        }
      };

      document.getElementById("goal-plus").addEventListener("click", () => adjustGoal(1));
      document.getElementById("goal-minus").addEventListener("click", () => adjustGoal(-1));

      ["throw", "give", "sell"].forEach((type) => {
        document.getElementById(`${type}-plus`).addEventListener("click", () => adjustCategory(type, 1));
        document.getElementById(`${type}-minus`).addEventListener("click", () => adjustCategory(type, -1));
      });

      updateDisplay();
    });
  </script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body
  class="bg-gradient-to-br from-gray-900 to-gray-800 text-white font-sans p-4 min-h-screen flex flex-col items-center justify-start">

  <!-- Goal Section -->
  <div class="w-full max-w-md text-center mb-8 mt-4">
    <h1 class="text-lg font-semibold mb-2 tracking-wide drop-shadow-sm">
      <span class="text-gray-300 font-extrabold">RidRally:</span><span
        class="ml-2 bg-gradient-to-r from-green-400 via-blue-400 to-blue-600 bg-clip-text text-transparent">Throw Away,
        Give Away, Sell Away</span>
    </h1>

    <div class="max-w-md mx-auto text-center mb-6">
      <button aria-expanded="false"
        class="learn-more-btn flex items-center text-sm text-blue-400 mx-auto focus:outline-none"
        onclick="toggleLearnMore(this)">
        <span class="btn-text">Learn more</span>
        <svg class="ml-1 w-4 h-4 transition-transform duration-300" fill="none" stroke="currentColor" stroke-width="2"
          viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
        </svg>
      </button>
    </div>

    <div id="intro-full" class="max-w-md mx-auto text-center text-gray-300 hidden">
      <p class="mb-4">
        Ready to start the month with a goal to get rid of stuff? Whether you're single, married, or bringing the whole
        family along for the ride, this app helps you stay accountable and make real progress toward getting rid of what
        you don't needâ€”and creating momentum for positive change in your life. Letâ€™s do this! ğŸ’ª
      </p>
      <p class="mb-4">
        <strong>Throw away:</strong> Aim for this to be your main source of riddance.
      </p>
      <p class="mb-4">
        <strong>Give away:</strong> This is your go-to for second chances: thrift stores, friends, or coworkers.
      </p>
      <p class="mb-4">
        <strong>Sell away:</strong> Letâ€™s be honest â€” how often do we say, â€˜Iâ€™m just trying to sell this,â€™ but
        never really follow through? Donâ€™t make this your last resort: if you canâ€™t sell it, give it away or throw it
        out!
      </p>
    </div>

    <script>
      function toggleLearnMore(btn) {
        const fullText = document.getElementById('intro-full');
        const btnText = btn.querySelector('.btn-text');
        const isHidden = fullText.classList.contains('hidden');

        if (isHidden) {
          fullText.classList.remove('hidden');
          btn.setAttribute('aria-expanded', 'true');
          btn.querySelector('svg').classList.add('rotate-180');
          btnText.textContent = 'Show less';
        } else {
          fullText.classList.add('hidden');
          btn.setAttribute('aria-expanded', 'false');
          btn.querySelector('svg').classList.remove('rotate-180');
          btnText.textContent = 'Learn more';
        }
      }
    </script>

    <h2 id="goal-title" class="text-2xl font-bold mb-3 tracking-tight">ğŸ¯ My Monthly Goal</h1>

      <div class="flex items-center justify-center space-x-4 text-4xl font-extrabold">
        <button id="goal-minus"
          class="w-12 h-12 bg-red-500 bg-opacity-30 text-red-300 hover:bg-opacity-50 rounded-full flex items-center justify-center transition">â€“</button>
        <span id="goal-value">60</span>
        <button id="goal-plus"
          class="w-12 h-12 bg-green-500 bg-opacity-30 text-green-300 hover:bg-opacity-50 rounded-full flex items-center justify-center transition">+</button>
      </div>

      <div id="progress-wrapper" class="hidden mt-3 text-sm text-gray-300">
        <span id="remaining">60</span>
      </div>
      <div class="hidden" id="special-bonus-power">
        <style>
          @keyframes gradient-move {
            0% {
              background-position: 0% 50%;
            }

            100% {
              background-position: 200% 50%;
            }
          }

          .animate-gradient-move {
            background-size: 200% 200%;
            animation: gradient-move 2s linear infinite;
            /* faster: 2s instead of 4s */
          }
        </style>

        <button onclick="playAirhorn()" class="px-6 py-3 text-lg font-bold text-white rounded-lg shadow-md
         bg-gradient-to-r from-pink-500 via-green-400 to-green-600
         animate-gradient-move
         hover:from-pink-600 hover:via-green-500 hover:to-green-700
         active:scale-95 transition transform duration-150 ease-in-out mt-4 mb-4">
          ğŸ”Š Letâ€™s Crank It Up! ğŸ”Š
        </button>

        <audio id="airhorn-sound" src="https://www.myinstants.com/media/sounds/airhorn.mp3" preload="auto"></audio>

        <script>
          function playAirhorn() {
            const sound = document.getElementById('airhorn-sound');
            sound.currentTime = 0;
            sound.play();
          }
        </script>
      </div>
  </div>

  <!-- Category Controls -->
  <div class="space-y-6 w-full max-w-md">

    <!-- Throw Away -->
    <div
      class="bg-gradient-to-br from-indigo-600/20 to-purple-600/10 backdrop-blur-md rounded-2xl p-5 shadow-lg flex items-center justify-between">
      <div class="text-lg font-medium">ğŸ—‘ï¸ Throw Away</div>
      <div class="flex items-center space-x-3">
        <button id="throw-minus"
          class="w-10 h-10 bg-red-500 bg-opacity-30 text-red-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">â€“</button>
        <span id="throw-value" class="text-xl font-semibold text-white">0</span>
        <button id="throw-plus"
          class="w-10 h-10 bg-green-500 bg-opacity-30 text-green-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">+</button>
      </div>
    </div>

    <!-- Give Away -->
    <div
      class="bg-gradient-to-br from-emerald-600/20 to-cyan-600/10 backdrop-blur-md rounded-2xl p-5 shadow-lg flex items-center justify-between">
      <div class="text-lg font-medium">ğŸ Give Away</div>
      <div class="flex items-center space-x-3">
        <button id="give-minus"
          class="w-10 h-10 bg-red-500 bg-opacity-30 text-red-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">â€“</button>
        <span id="give-value" class="text-xl font-semibold text-white">0</span>
        <button id="give-plus"
          class="w-10 h-10 bg-green-500 bg-opacity-30 text-green-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">+</button>
      </div>
    </div>

    <!-- Sell Away -->
    <div
      class="bg-gradient-to-br from-yellow-600/20 to-orange-600/10 backdrop-blur-md rounded-2xl p-5 shadow-lg flex items-center justify-between">
      <div class="text-lg font-medium">ğŸ’° Sell Away</div>
      <div class="flex items-center space-x-3">
        <button id="sell-minus"
          class="w-10 h-10 bg-red-500 bg-opacity-30 text-red-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">â€“</button>
        <span id="sell-value" class="text-xl font-semibold text-white">0</span>
        <button id="sell-plus"
          class="w-10 h-10 bg-green-500 bg-opacity-30 text-green-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">+</button>
      </div>
    </div>

  </div>
  <p class="mt-12 text-xs text-gray-400 text-center max-w-md">
    *This site uses <code>localStorage</code>. Your data will be lost if you use a private/incognito window or clear
    your browser cache. Until I add a back-end, consider taking a screenshot every now and then.
  </p>
</body>

</html>
