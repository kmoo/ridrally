<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rid Rally: Monthly Riddance Goal Tracker</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png" />
    <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <script defer>
        const ORIGINAL_GOAL = 25;
        // UUID generator (v4)
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        const DEVICE_KEY = (() => {
            let id = localStorage.getItem('device-id');
            if (!id) {
                id = generateUUID();
                localStorage.setItem('device-id', id);
            }
            return id;
        })();

        const now = new Date();
        const monthYear = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
        const STORAGE_KEY = `goal-tracker-${DEVICE_KEY}-${monthYear}`;

        document.addEventListener("DOMContentLoaded", () => {
            // Load from query params
            function getUrlParams() {
                const params = new URLSearchParams(window.location.search);
                return {
                    goalValue: params.has('goalValue') ? parseInt(params.get('goalValue')) : null,
                    throwValue: params.has('throwValue') ? parseInt(params.get('throwValue')) : null,
                    giveValue: params.has('giveValue') ? parseInt(params.get('giveValue')) : null,
                    sellValue: params.has('sellValue') ? parseInt(params.get('sellValue')) : null,
                };
            }
            const params = getUrlParams();
            // done

            const goalTitleEl = document.getElementById("goal-title");
            const monthNames = [
                "January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const now = new Date();
            const currentMonthName = monthNames[now.getMonth()];
            goalTitleEl.textContent = `üéØ My ${currentMonthName} Goal`;
            // State
            let originalGoal = ORIGINAL_GOAL;
            let goal = originalGoal;
            let progress = { throw: 0, give: 0, sell: 0 };

            // DOM Elements
            const goalEl = document.getElementById("goal-value");
            const remainingEl = document.getElementById("remaining");

            // Load saved data
            const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));

            // If any URL param present, override saved and defaults, and save
            if (
                params.goalValue !== null ||
                params.throwValue !== null ||
                params.giveValue !== null ||
                params.sellValue !== null
            ) {
                originalGoal = params.goalValue !== null ? params.goalValue : ORIGINAL_GOAL;
                goal = originalGoal;
                progress.throw = params.throwValue !== null ? params.throwValue : 0;
                progress.give = params.giveValue !== null ? params.giveValue : 0;
                progress.sell = params.sellValue !== null ? params.sellValue : 0;

                localStorage.setItem(STORAGE_KEY, JSON.stringify({
                    originalGoal,
                    goal,
                    progress
                }));

                // Remove URL params without reloading and then redirect home
                const cleanUrl = window.location.origin + window.location.pathname;
                window.history.replaceState({}, document.title, cleanUrl);

                // Redirect to home page (you can change '/' to your actual homepage path)
                window.location.href = '/';
            }
            // Else if saved data exists, use it
            else if (saved) {
                originalGoal = saved.originalGoal;
                goal = saved.goal;
                progress = saved.progress;
            }

            const updateDisplay = () => {
                goalEl.textContent = goal;
                const total = progress.throw + progress.give + progress.sell;
                const remaining = goal - total;
                const remainingEl = document.getElementById("remaining");
                const specialPower = document.getElementById('special-bonus-power');

                document.getElementById("throw-value").textContent = progress.throw;
                document.getElementById("give-value").textContent = progress.give;
                document.getElementById("sell-value").textContent = progress.sell;

                const showProgress = !(goal === originalGoal && total === 0);
                document.getElementById("progress-wrapper").classList.toggle("hidden", !showProgress);

                // Reset classes
                remainingEl.classList.remove("text-white", "text-green-400", "font-normal");

                if (remaining > 0) {
                    // Still under goal
                    remainingEl.textContent = `Only ${remaining} more items left to go! üëç`;
                    remainingEl.classList.add("text-white", "font-normal");
                } else if (remaining === 0) {
                    // Exactly hit the goal
                    remainingEl.textContent = `Goal met! üòé Why not one more?`;
                    remainingEl.classList.add("text-green-400", "font-bold");
                } else {
                    // Surpassed the goal
                    remainingEl.textContent = `+${Math.abs(remaining)} over. üéâ`;
                    remainingEl.classList.add("text-green-400", "font-extrabold");
                    specialPower.classList.remove('hidden');
                }

                // Save
                localStorage.setItem(STORAGE_KEY, JSON.stringify({
                    originalGoal,
                    goal,
                    progress
                }));
            };

            const adjustGoal = (delta) => {
                goal += delta;
                updateDisplay();
            };

            const adjustCategory = (type, delta) => {
                if (progress[type] + delta >= 0) {
                    progress[type] += delta;
                    updateDisplay();
                }
            };

            document.getElementById("goal-plus").addEventListener("click", () => adjustGoal(1));
            document.getElementById("goal-minus").addEventListener("click", () => adjustGoal(-1));

            ["throw", "give", "sell"].forEach((type) => {
                document.getElementById(`${type}-plus`).addEventListener("click", () => adjustCategory(type, 1));
                document.getElementById(`${type}-minus`).addEventListener("click", () => adjustCategory(type, -1));
            });

            updateDisplay();
        });

        function showMotivationModal({ motivation, credit, cta }) {
            const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
            const isDisabled = localStorage.getItem('motivation_disabled') === 'true';

            console.log(`Saved data: ${JSON.stringify(saved)}`);
            console.log(`Is motivation disabled? ${isDisabled}`);
            if (!saved || isDisabled) return;

            const lastShown = localStorage.getItem('motivation_last_shown');
            const today = new Date().toISOString().split('T')[0];

            console.log(`Last shown: ${lastShown}, Today: ${today}`);

            if (lastShown === today) return;

            localStorage.setItem('motivation_last_shown', today);

            const gradients = [
                'from-green-400 via-blue-500 to-purple-600',
                'from-indigo-500 via-purple-500 to-pink-500',
                'from-pink-500 via-red-500 to-yellow-500',
                'from-yellow-400 via-red-500 to-pink-500',
                'from-blue-400 via-cyan-500 to-teal-500',
                'from-orange-400 via-red-500 to-pink-500',
                'from-rose-400 via-fuchsia-500 to-indigo-500'
            ];
            const gradient = gradients[new Date().getDay()];

            const existing = document.getElementById('motivation-modal');
            if (existing) existing.remove();

            const modal = document.createElement('div');
            modal.id = 'motivation-modal';
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60';
            modal.innerHTML = `
            <div class="max-w-md w-full mx-4 rounded-xl shadow-xl transform transition-all bg-gradient-to-br ${gradient} text-white p-6 relative animate-fadeIn min-h-[40vh] sm:min-h-[30vh] flex items-center">
                <button class="absolute top-3 right-3 text-white text-2xl hover:scale-110 transform transition" onclick="document.getElementById('motivation-modal').remove()">√ó</button>
                <div class="text-center space-y-4 w-full">
                <h2 class="text-2xl font-bold mb-2">Motivation of the Day</h2>
                <p class="text-lg text-black sm:text-xl font-semibold leading-snug">${motivation}</p>
                <p class="text-sm italic opacity-80">(Source: ${credit})</p>
                <button class="mt-4 px-5 py-2 bg-white text-gray-800 font-semibold rounded-md hover:bg-gray-200 transition"
                    onclick="document.getElementById('motivation-modal').remove()">
                    Close
                </button>
                <br/>
                <button onclick="disableMotivation()" class="text-sm underline text-white hover:text-gray-300 mt-2">
                    Don‚Äôt show this again
                </button>
                </div>
            </div>
            `;

            document.body.appendChild(modal);
        }

        function disableMotivation() {
            localStorage.setItem('motivation_disabled', 'true');
            const modal = document.getElementById('motivation-modal');
            if (modal) modal.remove();
        }

        function getMotivation() {
            return [
                {
                    "motivation": "80% of Americans feel overwhelmed by clutter in their homes.",
                    "credit": "wifitalents.com",
                    "cta": "Clear Your Space"
                },
                {
                    "motivation": "56% report anxiety or stress when their space is cluttered.",
                    "credit": "wifitalents.com",
                    "cta": "Start Small"
                },
                {
                    "motivation": "Decluttering can reduce cortisol (stress hormone) levels by about 20%.",
                    "credit": "wifitalents.com",
                    "cta": "Reduce Stress"
                },
                {
                    "motivation": "89% of women and 77% of men feel better after organizing their home.",
                    "credit": "wifitalents.com",
                    "cta": "Feel Better"
                },
                {
                    "motivation": "People who declutter regularly are 35% more likely to feel calm and relaxed at home.",
                    "credit": "wifitalents.com",
                    "cta": "Create Calm"
                },
                {
                    "motivation": "Clutter can reduce overall happiness scores by up to 15%.",
                    "credit": "wifitalents.com",
                    "cta": "Boost Happiness"
                },
                {
                    "motivation": "Clutter increases the risk of household accidents‚Äîfalls by ~30%.",
                    "credit": "wifitalents.com",
                    "cta": "Make It Safer"
                },
                {
                    "motivation": "Residents walk more (~15 min/day) after tidying up.",
                    "credit": "wifitalents.com",
                    "cta": "Move More"
                },
                {
                    "motivation": "Clutter causes decision fatigue‚Äîdecision‚Äëmaking drops by ~15%.",
                    "credit": "gitnux.org",
                    "cta": "Think Clearly"
                },
                {
                    "motivation": "Americans spend ~2.5 days/year searching for misplaced items.",
                    "credit": "parking-mobility.org",
                    "cta": "Save Time"
                },
                {
                    "motivation": "Americans pay ~$2,000/year replacing lost items.",
                    "credit": "medium.com",
                    "cta": "Stop Wasting Money"
                },
                {
                    "motivation": "Clutter can reduce productivity by up to 40%.",
                    "credit": "zipdo.co",
                    "cta": "Boost Focus"
                },
                {
                    "motivation": "78% say a tidy space boosts focus; 83% say it sparks creativity.",
                    "credit": "parking-mobility.org",
                    "cta": "Tidy Up"
                },
                {
                    "motivation": "A cluttered home contributes to late bill payments for ~23% of adults.",
                    "credit": "medium.com",
                    "cta": "Stay Organized"
                },
                {
                    "motivation": "Over 300,000 items live in the average American household.",
                    "credit": "bintheredumpthatusa.com",
                    "cta": "Own Less"
                },
                {
                    "motivation": "80% of items in homes go unused.",
                    "credit": "wethreeshanes.com",
                    "cta": "Let It Go"
                },
                {
                    "motivation": "‚ÄúThe things you own end up owning you.‚Äù",
                    "credit": "Chuck Palahniuk",
                    "cta": "Break Free"
                },
                {
                    "motivation": "‚ÄúHave nothing in your house that you do not know to be beautiful or believe to be useful.‚Äù",
                    "credit": "William Morris",
                    "cta": "Choose Wisely"
                },
                {
                    "motivation": "‚ÄúIf it only takes five minutes, just do it.‚Äù",
                    "credit": "reddit.com/r/declutter",
                    "cta": "Just Do It"
                },
                {
                    "motivation": "Decluttering reduces depression symptoms and improves self-esteem (~25%).",
                    "credit": "wifitalents.com",
                    "cta": "Feel Lighter"
                },
                {
                    "motivation": "Over 90% say a clutter‚Äëfree space helps them feel more relaxed and productive.",
                    "credit": "twomenandajunktruck.com",
                    "cta": "Relax More"
                },
                {
                    "motivation": "Clean homes support better sleep, healthier eating, and less fatigue.",
                    "credit": "webmd.com",
                    "cta": "Sleep Better"
                },
                {
                    "motivation": "Clutter increases noise and visual distractions, raising stress levels.",
                    "credit": "gitnux.org",
                    "cta": "Quiet the Chaos"
                },
                {
                    "motivation": "Nearly 50% of couples argue over clutter.",
                    "credit": "wethreeshanes.com",
                    "cta": "Declutter Together"
                },
                {
                    "motivation": "Half of people believe they could be happy with most possessions gone.",
                    "credit": "time.com",
                    "cta": "Choose Less"
                },
                {
                    "motivation": "‚ÄúThe long‚Äëterm peace of less surpasses the short‚Äëterm thrill of more.‚Äù",
                    "credit": "reddit.com/r/minimalism",
                    "cta": "Seek Peace"
                },
                {
                    "motivation": "Organizing your space restores control and reduces overwhelm.",
                    "credit": "nypost.com",
                    "cta": "Take Control"
                },
                {
                    "motivation": "Decluttering often leads to redecorating with more meaning.",
                    "credit": "storeitrightnow.com",
                    "cta": "Add Meaning"
                },
                {
                    "motivation": "‚ÄúThe practical benefits of owning less are more money, more time, more calm, more freedom.‚Äù",
                    "credit": "Joshua Becker",
                    "cta": "Live With Less"
                },
                {
                    "motivation": "Every item you own takes up not just space, but mental energy.",
                    "credit": "theminimalists.com",
                    "cta": "Protect Energy"
                },
                {
                    "motivation": "Donating unused items helps someone in need‚Äîand frees up space.",
                    "credit": "goodwill.org",
                    "cta": "Donate Today"
                },
                {
                    "motivation": "Cluttered homes can lead to more procrastination.",
                    "credit": "psychologytoday.com",
                    "cta": "Take Action"
                },
                {
                    "motivation": "Decluttering is self-respect‚Äîit shows you value your space and time.",
                    "credit": "becomingminimalist.com",
                    "cta": "Honor Your Space"
                }
            ][(new Date().getDate() - 1)];
        }

    </script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body
    class="bg-gradient-to-br from-gray-900 to-gray-800 text-white font-sans p-4 min-h-screen flex flex-col items-center justify-start">

    <!-- Goal Section -->
    <div class="w-full max-w-md text-center mb-8 mt-4">
        <div class="bg-gradient-to-br from-gray-400/20 to-black-600/10 backdrop-blur-md rounded-2xl shadow-lg p-4 mb-8">
            <h1 class="text-lg font-semibold tracking-wide p-2">
                <span class="text-gray-300 font-extrabold">RidRally:</span><span
                    class="ml-2 bg-gradient-to-r from-green-400 via-blue-400 to-blue-600 bg-clip-text text-transparent">Throw
                    Away,
                    Give Away, Sell Away</span>
            </h1>

            <div class="max-w-md mx-auto text-center">
                <button aria-expanded="false"
                    class="learn-more-btn flex items-center text-sm text-blue-400 mx-auto focus:outline-none pb-2"
                    onclick="toggleLearnMore(this)">
                    <span class="btn-text">Learn more</span>
                    <svg class="ml-1 w-4 h-4 transition-transform duration-300" fill="none" stroke="currentColor"
                        stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>
            </div>

            <div id="intro-full" class="max-w-md mx-auto text-center text-gray-300 hidden">
                <p class="mb-4">
                    Ready to start the month with a goal to get rid of stuff? Whether you're single, married, or
                    bringing
                    the whole
                    family along for the ride, this app helps you stay accountable and make real progress toward getting
                    rid
                    of what
                    you don't need‚Äîand creating momentum for positive change in your life. Let‚Äôs do this! üí™
                </p>
                <p class="mb-4">
                    <strong>Throw away:</strong> Aim for this to be your main source of riddance.
                </p>
                <p class="mb-4">
                    <strong>Give away:</strong> This is your go-to for second chances: thrift stores, friends, or
                    coworkers.
                </p>
                <p class="mb-4">
                    <strong>Sell away:</strong> Let‚Äôs be honest ‚Äî how often do we say, ‚ÄòI‚Äôm just trying to sell this,‚Äô
                    but
                    never really follow through? Don‚Äôt make this your last resort: if you can‚Äôt sell it, give it away or
                    throw it
                    out!
                </p>
            </div>
        </div>

        <script>
            function toggleLearnMore(btn) {
                const fullText = document.getElementById('intro-full');
                const btnText = btn.querySelector('.btn-text');
                const isHidden = fullText.classList.contains('hidden');

                if (isHidden) {
                    fullText.classList.remove('hidden');
                    btn.setAttribute('aria-expanded', 'true');
                    btn.querySelector('svg').classList.add('rotate-180');
                    btnText.textContent = 'Show less';
                } else {
                    fullText.classList.add('hidden');
                    btn.setAttribute('aria-expanded', 'false');
                    btn.querySelector('svg').classList.remove('rotate-180');
                    btnText.textContent = 'Learn more';
                }
            }
        </script>

        <h2 id="goal-title" class="text-2xl font-bold mb-3 tracking-tight">üéØ My Monthly Goal</h1>

            <div class="flex items-center justify-center space-x-4 text-4xl font-extrabold">
                <button id="goal-minus"
                    class="w-12 h-12 bg-red-500 bg-opacity-30 text-red-300 hover:bg-opacity-50 rounded-full flex items-center justify-center transition">‚Äì</button>
                <span id="goal-value">60</span>
                <button id="goal-plus"
                    class="w-12 h-12 bg-green-500 bg-opacity-30 text-green-300 hover:bg-opacity-50 rounded-full flex items-center justify-center transition">+</button>
            </div>

            <div id="progress-wrapper" class="hidden mt-3 text-lg font-normal text-white">
                <span id="remaining">60</span>
            </div>
            <div class="hidden" id="special-bonus-power">
                <style>
                    @keyframes gradient-move {
                        0% {
                            background-position: 0% 50%;
                        }

                        100% {
                            background-position: 200% 50%;
                        }
                    }

                    .animate-gradient-move {
                        background-size: 200% 200%;
                        animation: gradient-move 2s linear infinite;
                        /* faster: 2s instead of 4s */
                    }
                </style>

                <button onclick="playAirhorn()" class="px-6 py-3 text-lg font-bold text-white rounded-lg shadow-md
         bg-gradient-to-r from-pink-500 via-green-400 to-green-600
         animate-gradient-move
         hover:from-pink-600 hover:via-green-500 hover:to-green-700
         active:scale-95 transition transform duration-150 ease-in-out mt-4 mb-4">
                    üîä Let‚Äôs Crank It Up! üîä
                </button>

                <audio id="airhorn-sound" src="https://www.myinstants.com/media/sounds/airhorn.mp3"
                    preload="auto"></audio>

                <script>
                    function playAirhorn() {
                        const sound = document.getElementById('airhorn-sound');
                        sound.currentTime = 0;
                        sound.play();
                    }
                </script>
            </div>
    </div>

    <!-- Category Controls -->
    <div class="space-y-6 w-full max-w-md">

        <!-- Throw Away -->
        <div
            class="bg-gradient-to-br from-indigo-600/20 to-purple-600/10 backdrop-blur-md rounded-2xl p-5 shadow-lg flex items-center justify-between">
            <div class="text-lg font-normal">üóëÔ∏è Throw Away</div>
            <div class="flex items-center space-x-3">
                <button id="throw-minus"
                    class="w-10 h-10 bg-red-500 bg-opacity-30 text-red-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">‚Äì</button>
                <span id="throw-value" class="text-xl font-semibold text-white">0</span>
                <button id="throw-plus"
                    class="w-10 h-10 bg-green-500 bg-opacity-30 text-green-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">+</button>
            </div>
        </div>

        <!-- Give Away -->
        <div
            class="bg-gradient-to-br from-emerald-600/20 to-cyan-600/10 backdrop-blur-md rounded-2xl p-5 shadow-lg flex items-center justify-between">
            <div class="text-lg font-normal">üéÅ Give Away</div>
            <div class="flex items-center space-x-3">
                <button id="give-minus"
                    class="w-10 h-10 bg-red-500 bg-opacity-30 text-red-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">‚Äì</button>
                <span id="give-value" class="text-xl font-semibold text-white">0</span>
                <button id="give-plus"
                    class="w-10 h-10 bg-green-500 bg-opacity-30 text-green-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">+</button>
            </div>
        </div>

        <!-- Sell Away -->
        <div
            class="bg-gradient-to-br from-yellow-600/20 to-orange-600/10 backdrop-blur-md rounded-2xl p-5 shadow-lg flex items-center justify-between">
            <div class="text-lg font-normal">üí∞ Sell Away</div>
            <div class="flex items-center space-x-3">
                <button id="sell-minus"
                    class="w-10 h-10 bg-red-500 bg-opacity-30 text-red-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">‚Äì</button>
                <span id="sell-value" class="text-xl font-semibold text-white">0</span>
                <button id="sell-plus"
                    class="w-10 h-10 bg-green-500 bg-opacity-30 text-green-200 hover:bg-opacity-50 rounded-full flex items-center justify-center text-xl">+</button>
            </div>
        </div>

    </div>
    <p class="mt-12 text-xs text-gray-400 text-center max-w-md">
        *This site uses <code>localStorage</code>. Your data will be lost if you use a private/incognito window or clear
        your browser cache. Until I add a back-end, consider taking a screenshot every now and then.
    </p>
    <div class="text-gray-500 text-sm mt-4 text-center mb-8">
        ¬© <span id="currentYear">2025</span> <a href="https://lukemoorman.com"
            class="text-blue-400 hover:underline">Luke Moorman</a>
        <script>
            document.getElementById("currentYear").innerHTML =
                new Date().getFullYear();
        </script>
    </div>
    <script>showMotivationModal(getMotivation());</script>
</body>

</html>